<!DOCTYPE HTML>
<!--
	Strata by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>Samsara Counts</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<!--[if lte IE 8]><script src="assets/js/ie/html5shiv.js"></script><![endif]-->
		<link rel="stylesheet" href="assets/css/main.css" />
		<!--[if lte IE 8]><link rel="stylesheet" href="assets/css/ie8.css" /><![endif]-->
	</head>
	<body id="top">
<!-- Header -->
			<header id="header">
				<div class="inner">
					<a href="http://samsaranc.github.io" class="image avatar"><img src="images/avatar.jpg" alt="" /></a>
					<h1><strong></a><a href="http://samsaranc.github.io">Samsara Counts</a></strong></br>
					<a href="http://cs.seas.gwu.edu">Computer Science</a> + <a href="http://math.columbian.gwu.edu">Mathematics</a><br/> student and researcher
					attending <a href="http://www.gwu.edu">the George Washington University</a>. Previously at UMD's <a href="http://www.cs.umd.edu/projects/reucaar/">REU CAAR</a>
				    <h3><a href="pubs.html">Publications</a></h3>
					<h3><a href="portfolio.html">Portfolio</a></h3>
                    <h3><a href="cv_index.html">Computer Vision</a></h3>
					<h3><a href="http://undecidabi1ity.tumblr.com/">Academic Blog</a></h3>
				</div>
			</header>

		<!-- Main -->
			<div id="main">
				<section>
							<h1><a href="http://robertpless.com/classes/ComputerVision/FinalProject/index.html">Computer Vision Final Project </a>: Recognizing Images with Deep Learning </h1>
							<p>
							<h3>Introduction:</h3>				
							
							Eating disorders (ED) are pervasive and do not discriminate based on race, religion, gender, or socioeconomic status. Comorbidities include anxiety, depression, substance abuse, self-injurious behaviors, and history of trauma. ED are often a lifelong struggle, with approximately 2/3 of patients never achieving a full and sustained remission.</br>
							Exposure to media expressing “the thin ideal” can be triggering to individuals with ED as well as those at risk for developing them. Social media is rife with these triggers. Concurrent with the rise of social media, individuals with ED have created communities in which they support one another in the dangerous pursuit of this illness' goal: to be “thin enough.” Websites promoting anorexia (pro-ana) and ED as lifestyle choices valorize acting on ED symptoms. Such sites teach those suffering or at risk from ED how to act on the illness and support them in doing so, putting
							them at risk for severe health complications.</br>

							The impact of images in this community far exceeds that of other communities surrounding
							physical and mental health issues. Therefore, it is essential that clinicians and family members be able to identify websites containing images associated with the promotion of ED to prevent exposure to these triggers. My project, part of my ongoing work with Dr. Pless, aims to use deep learning to automatically detect such triggering material, with the ultimate goal of designing parental and clinical controls to classify internet content.</br> 

							I decided to use machine learning to identify pro-ana and pro-eating disorder content, trained on example data from online social media searches. </br> </br>


<h3>Dataset gathering:</h3>
							Over the past 8 months, our research group has accumulated a massive, hashtag-labeled dataset. We used python to scrape the images from twitter, tumblr, and flickr. I chose hashtags to get us training data that compares pro-ana content with other content similar in demographics and photographic style. We scraped images from each hashtag-based category: 

							<ul>
							<li>#proana</li> 
							<li>#selfie</li>
							<li>#ootd</li>
							<li>#greek</li>
						</ul>
							<h3>Sample Images from each category<h3>
							<a href="images/fulls/CVproana.png" class="image fit thumb"><img src="images/fulls/CVproana.png" alt="Computer Vision Proana tumblr dataset featuring images of individuals with Eating Disorders and images that fall under the hashtag #selfie or #ootd" /></a>

							<table style="width:100%">
							  <tr>
							  	<td><h4>proana</h4><img src= "images/cv-18/p4/pa1.jpg" alt="color image"></img></td>
							   <!--  <td><h4>Gradient final image</h4><img src= "images/cv-18/p1/c_00106v.jpg" alt="color image"></img></td> -->
							    <td><h4>not proana</h4><img src= "images/cv-18/p4/.jpg" alt="green image"></img></td> 
							    
							  </tr>
							</table>



							<h3>Classifier Design</h3>

									<p>In designing the classifier, I chose the training data to compare pro-ana content with other content similar in demographics and photographic style, composed of the hashtag-based categories #proana, #selfie, #ootd, and #greek. These were 4 <strong>distinct</strong> classes.</p>




							The hashtags #selfie, #ootd, and #greek made up the non-pro-ana class (NPA). #proana was the proana class (PA). 


							<h3>Implementation:</h3>

							I used PyTorch and the <a href="https://arxiv.org/abs/1512.03385">Resnet Deep Learning</a> framework pretrained on the <a href="http://www.image-net.org/">ImageNet dataset</a>. I trained the last several layers of the model into the two categories: proana (PA) and not proana (NA).<br>



							<h4>Training settings</h4>
								I used the following settings when training the Resnet architecture.

							<ul>
								<li>Solver: Stochastic Gradient Descent (SGD )</li>

								<li>Initial learning rate 0.1</li>

								<li>learning rate decay factor: 0.1</li>

								<li>Momentum: 0.9</li>

								<li>Decay epochs: 16</li>

								<li>Batch size: 175</li>

								<li>Total Epochs: 15</li>

								<li>layers:  512</li>

								<li>Hardware: 2 NVIDIA Teslas (accessed via linux server)</li>
							</ul>

							<h3>Training Results</h3>
							<p> 
								In the first iteration, I randomly chose 20% of these images as test data and trained the <a href="https://arxiv.org/abs/1512.03385">Resnet</a> neural network to classify the remaining images. On test data this gives 80% classification accuracy—a significant improvement over chance (50%). </br>

								
								<img src= "acc.jpg" alt="color image"></img>
								<img src= "loss.jpg" alt="color image"></img>
							</p>

							<h3>Stress-testing Results</h3>
					
							To assess the robustness of our classifier, I examined its
performance on images with subjects and demographics
underrepresented in our training set. With n=2436 photos, I evaluated our dataset for "challenging" non-pro-ana (NPA) and pro-ana (PA) examples.

In the PA set, one site contained images of men; the rest
were similar to our pro-ana set. For the non-pro-ana NPA set, we
selected sites that were likely to show underweight people, a
proliferation of exposed skin, or people of color.

Here is a sample of some of the images:

<img src= "images/cv-18/p4/stress_test.png" alt="color image"></img>

The total results of the tests and classification of each set of images is here:
<img src= "images/cv-18/p4/test2.png" alt="color image"></img>
</p>

<p>Despite our hypothesis that roughly half of the image
types in the pro-ana test set would be difficult to classify, the
results are encouraging. However, we do have a problem with
pro-ana false positives. One potential explanation for this
could be class overlap and noisiness of the dataset: for
example, a pro-ana selfie is still a selfie. </p>

<h3>Conclusion</h3>
These results suggest that it is feasible to automatically detect social media sources with pro-eating disorder material with high accuracy. This could inform the creation of tools that can assist clinicians and family members to improve health outcomes for ED patients.</br>


							
							
						 
			    </section>
			</div>
<!-- Footer -->
			<footer id="footer">
				<div class="inner">
					<ul class="icons">
						<li><a href="https://github.com/samsaranc" class="icon fa-github"><span class="label">Github</span></a></li>
						<li> <a href="https://limeconnect-csm.symplicity.com/profiles/samsara.counts2">Lime Network</a></li>
						<li><a href="https://www.linkedin.com/in/samsaranc/" class="icon fa-linkedin"><span class="label">LinkedIn</span></a></li>
						<li><a href="https://twitter.com/samsaranc" class="icon fa-twitter"><span class="label">Twitter</span></a></li>
						<li><a href="mailto:samsaranc@gmail.com" class="icon fa-envelope-o"><span class="label">Email</span></a></li>
					</ul>
					<ul class="copyright">
						<li>Last updated: May 2018</li>
						<li>Design: <a href="http://html5up.net">HTML5 UP</a></li>
						<li>Background: <a href="https://www.lansbergen.net/wp/solargraphy/">Jan Koeman Kloetinge</a> </li>
					</ul>

				</div>
			</footer>


		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.poptrox.min.js"></script>
			<script src="assets/js/skel.min.js"></script>
			<script src="assets/js/util.js"></script>
			<!--[if lte IE 8]><script src="assets/js/ie/respond.min.js"></script><![endif]-->
			<script src="assets/js/main.js"></script>

	</body>
</html>
